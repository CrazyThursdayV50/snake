# 唐奇安通道策略 (Donchian Channel Strategy)

## 概述

唐奇安通道策略是一种基于价格突破的趋势跟踪策略，由理查德·唐奇安（Richard Donchian）开发。该策略利用唐奇安通道指标来识别潜在的趋势形成和反转点，通过价格突破通道上下轨来生成买入和卖出信号。这种策略在海龟交易系统中广泛应用，是经典的突破交易策略之一。

## 策略原理

唐奇安通道策略基于以下核心原则：

1. **趋势跟踪** - 通过识别价格突破来捕捉趋势的开始
2. **动态支撑/阻力** - 通过短周期唐奇安通道提供动态的支撑和阻力水平
3. **风险管理** - 基于账户风险比例和止损距离来确定头寸大小

## 策略逻辑

### 入场规则

1. **多头入场** - 当价格突破过去N天的最高价时，买入做多
2. **空头入场** - 当价格跌破过去N天的最低价时，卖出做空

### 出场规则

1. **多头出场** - 当价格跌破过去M天的最低价时（M < N），平掉多头仓位
2. **空头出场** - 当价格突破过去M天的最高价时（M < N），平掉空头仓位

### 风险管理

1. 根据账户总价值的一定比例（如1%）确定风险金额
2. 根据止损距离（通常基于短周期唐奇安通道）计算头寸规模
3. 头寸规模 = 风险金额 / 止损距离

## 默认参数设置

- 突破周期（N）：20天
- 退出周期（M）：10天
- 风险比例：账户总价值的1%

## 使用方法

```go
import (
    "snake/internal/strategy/donchian_strategy"
    "snake/internal/models"
)

// 创建策略实例
strategy := donchian_strategy.New()

// 自定义参数（可选）
strategy.SetParams(20, 10, decimal.NewFromFloat(1.0))

// 初始化策略
strategy.Init(initialPosition, initialBalance)

// 更新策略并获取交易信号
signal, err := strategy.Update(newKline)

// 根据信号执行交易
switch signal.Type {
case types.SignalTypeBuy:
    // 执行买入
case types.SignalTypeSell:
    // 执行卖出
case types.SignalTypeHold:
    // 持有不动
}
```

## 优势与注意事项

### 优势

1. 简单明确的交易规则，容易理解和实现
2. 能够有效捕捉大趋势，获取较大利润
3. 通过风险管理机制控制每笔交易的风险
4. 适用于多种市场和时间周期

### 注意事项

1. 趋势跟踪策略在震荡市场中可能产生频繁的假突破信号
2. 入场时机通常不是最优的（已经走出一定的趋势才确认信号）
3. 在快速反转行情中，止损可能相对滞后
4. 建议与其他技术指标或基本面分析相结合，提高信号的质量

## 实现细节

本策略基于snake/internal/indicates/donchian-channel包实现，主要包括以下组件：

1. **突破通道** - 用于入场信号的长周期唐奇安通道
2. **退出通道** - 用于出场信号的短周期唐奇安通道
3. **仓位计算器** - 基于风险比例和止损距离计算交易量
4. **状态管理** - 跟踪当前持仓状态（多头、空头或无仓位） 